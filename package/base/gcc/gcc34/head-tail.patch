# --- ROCK-COPYRIGHT-NOTE-BEGIN ---
# 
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# Please add additional copyright information _after_ the line containing
# the ROCK-COPYRIGHT-NOTE-END tag. Otherwise it might get removed by
# the ./scripts/Create-CopyPatch script. Do not edit this copyright text!
# 
# ROCK Linux: rock-src/package/base/gcc/gcc34/head-tail.patch
# ROCK Linux is Copyright (C) 1998 - 2006 Clifford Wolf
# 
# This patch file is dual-licensed. It is available under the license the
# patched project is licensed under, as long as it is an OpenSource license
# as defined at http://www.opensource.org/ (e.g. BSD, X11) or under the terms
# of the GNU General Public License as published by the Free Software
# Foundation; either version 2 of the License, or (at your option) any later
# version.
# 
# --- ROCK-COPYRIGHT-NOTE-END ---

diff -dur gcc-3.4.2/contrib/test_summary gcc-3.4.2-p/contrib/test_summary
--- gcc-3.4.2/contrib/test_summary	2004-08-26 07:49:13.000000000 +0200
+++ gcc-3.4.2-p/contrib/test_summary	2004-11-05 02:27:04.000000000 +0100
@@ -106,7 +106,7 @@
     srcdir = configflags;
     sub(/\/configure .*/, "", srcdir);
     printf "LAST_UPDATED: ";
-    system("tail -1 " srcdir "/LAST_UPDATED");
+    system("tail -n1 " srcdir "/LAST_UPDATED");
     print "";
 
     sub(/^[^ ]*\/configure */, " ", configflags);
diff -dur gcc-3.4.2/gcc/configure gcc-3.4.2-p/gcc/configure
--- gcc-3.4.2/gcc/configure	2004-07-13 08:58:29.000000000 +0200
+++ gcc-3.4.2-p/gcc/configure	2004-11-05 02:27:05.000000000 +0100
@@ -10127,7 +10127,7 @@
   # and we got the correct data, then succeed.
   if test x$gcc_cv_objdump != x \
   && $gcc_cv_objdump -s -j .eh_frame conftest.o 2>/dev/null \
-     | tail -3 > conftest.got \
+     | tail -n3 > conftest.got \
   && { cmp conftest.lit conftest.got > /dev/null 2>&1 \
     || cmp conftest.big conftest.got > /dev/null 2>&1; }
   then
diff -dur gcc-3.4.2/gcc/configure.ac gcc-3.4.2-p/gcc/configure.ac
--- gcc-3.4.2/gcc/configure.ac	2004-07-13 08:58:29.000000000 +0200
+++ gcc-3.4.2-p/gcc/configure.ac	2004-11-05 02:27:05.000000000 +0100
@@ -2018,7 +2018,7 @@
   # and we got the correct data, then succeed.
   if test x$gcc_cv_objdump != x \
   && $gcc_cv_objdump -s -j .eh_frame conftest.o 2>/dev/null \
-     | tail -3 > conftest.got \
+     | tail -n3 > conftest.got \
   && { cmp conftest.lit conftest.got > /dev/null 2>&1 \
     || cmp conftest.big conftest.got > /dev/null 2>&1; }
   then
diff -dur gcc-3.4.2/gcc/testsuite/ada/acats/run_all.sh gcc-3.4.2-p/gcc/testsuite/ada/acats/run_all.sh
--- gcc-3.4.2/gcc/testsuite/ada/acats/run_all.sh	2004-01-13 12:48:46.000000000 +0100
+++ gcc-3.4.2-p/gcc/testsuite/ada/acats/run_all.sh	2004-11-05 02:27:05.000000000 +0100
@@ -204,7 +204,7 @@
       ls ${i}?.adb > ${i}.lst 2> /dev/null
       ls ${i}*m.adb >> ${i}.lst 2> /dev/null
       ls ${i}.adb >> ${i}.lst 2> /dev/null
-      main=`tail -1 ${i}.lst`
+      main=`tail -n1 ${i}.lst`
       binmain=`echo $main | sed -e 's/\(.*\)\..*/\1/g'`
       echo "BUILD $main" >> $dir/acats.log
       EXTERNAL_OBJECTS=""
diff -dur gcc-3.4.2/libjava/acinclude.m4 gcc-3.4.2-p/libjava/acinclude.m4
--- gcc-3.4.2/libjava/acinclude.m4	2003-12-31 09:58:29.000000000 +0100
+++ gcc-3.4.2-p/libjava/acinclude.m4	2004-11-05 02:27:05.000000000 +0100
@@ -250,8 +250,8 @@
 AC_MSG_CHECKING(whether 'ld' is at least 2.13)
 LD_PROG=`$CC --print-prog-name=ld`
 LD_VERSION=`$LD_PROG --version`
-LD_VERSION_MAJOR=`echo "$LD_VERSION" | head -1 | cut -d '.' -f 1 | cut -d ' ' -f 4`
-LD_VERSION_MINOR=`echo "$LD_VERSION" | head -1 | cut -d '.' -f 2`
+LD_VERSION_MAJOR=`echo "$LD_VERSION" | head -n1 | cut -d '.' -f 1 | cut -d ' ' -f 4`
+LD_VERSION_MINOR=`echo "$LD_VERSION" | head -n1 | cut -d '.' -f 2`
 if expr "$LD_VERSION_MAJOR" \> 2 > /dev/null; then
   LD_OK="ok"
 else
diff -dur gcc-3.4.2/libjava/aclocal.m4 gcc-3.4.2-p/libjava/aclocal.m4
--- gcc-3.4.2/libjava/aclocal.m4	2004-09-07 01:31:35.000000000 +0200
+++ gcc-3.4.2-p/libjava/aclocal.m4	2004-11-05 02:27:05.000000000 +0100
@@ -262,8 +262,8 @@
 AC_MSG_CHECKING(whether 'ld' is at least 2.13)
 LD_PROG=`$CC --print-prog-name=ld`
 LD_VERSION=`$LD_PROG --version`
-LD_VERSION_MAJOR=`echo "$LD_VERSION" | head -1 | cut -d '.' -f 1 | cut -d ' ' -f 4`
-LD_VERSION_MINOR=`echo "$LD_VERSION" | head -1 | cut -d '.' -f 2`
+LD_VERSION_MAJOR=`echo "$LD_VERSION" | head -n1 | cut -d '.' -f 1 | cut -d ' ' -f 4`
+LD_VERSION_MINOR=`echo "$LD_VERSION" | head -n1 | cut -d '.' -f 2`
 if expr "$LD_VERSION_MAJOR" \> 2 > /dev/null; then
   LD_OK="ok"
 else
diff -dur gcc-3.4.2/libjava/configure gcc-3.4.2-p/libjava/configure
--- gcc-3.4.2/libjava/configure	2004-09-07 01:31:35.000000000 +0200
+++ gcc-3.4.2-p/libjava/configure	2004-11-05 02:27:05.000000000 +0100
@@ -3015,8 +3015,8 @@
 echo "configure:3016: checking whether 'ld' is at least 2.13" >&5
 LD_PROG=`$CC --print-prog-name=ld`
 LD_VERSION=`$LD_PROG --version`
-LD_VERSION_MAJOR=`echo "$LD_VERSION" | head -1 | cut -d '.' -f 1 | cut -d ' ' -f 4`
-LD_VERSION_MINOR=`echo "$LD_VERSION" | head -1 | cut -d '.' -f 2`
+LD_VERSION_MAJOR=`echo "$LD_VERSION" | head -n1 | cut -d '.' -f 1 | cut -d ' ' -f 4`
+LD_VERSION_MINOR=`echo "$LD_VERSION" | head -n1 | cut -d '.' -f 2`
 if expr "$LD_VERSION_MAJOR" \> 2 > /dev/null; then
   LD_OK="ok"
 else
diff -dur gcc-3.4.2/libstdc++-v3/acinclude.m4 gcc-3.4.2-p/libstdc++-v3/acinclude.m4
--- gcc-3.4.2/libstdc++-v3/acinclude.m4	2004-07-15 19:42:45.000000000 +0200
+++ gcc-3.4.2-p/libstdc++-v3/acinclude.m4	2004-11-05 02:27:05.000000000 +0100
@@ -273,7 +273,7 @@
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
   changequote(,)
-  ldver=`$LD --version 2>/dev/null | head -1 | \
+  ldver=`$LD --version 2>/dev/null | head -n1 | \
          sed -e 's/GNU ld version \([0-9.][0-9.]*\).*/\1/'`
   changequote([,])
   glibcxx_gnu_ld_version=`echo $ldver | \
diff -dur gcc-3.4.2/libstdc++-v3/aclocal.m4 gcc-3.4.2-p/libstdc++-v3/aclocal.m4
--- gcc-3.4.2/libstdc++-v3/aclocal.m4	2004-08-13 22:44:03.000000000 +0200
+++ gcc-3.4.2-p/libstdc++-v3/aclocal.m4	2004-11-05 02:27:05.000000000 +0100
@@ -286,7 +286,7 @@
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
   changequote(,)
-  ldver=`$LD --version 2>/dev/null | head -1 | \
+  ldver=`$LD --version 2>/dev/null | head -n1 | \
          sed -e 's/GNU ld version \([0-9.][0-9.]*\).*/\1/'`
   changequote([,])
   glibcxx_gnu_ld_version=`echo $ldver | \
diff -dur gcc-3.4.2/libstdc++-v3/configure gcc-3.4.2-p/libstdc++-v3/configure
--- gcc-3.4.2/libstdc++-v3/configure	2004-08-13 22:44:04.000000000 +0200
+++ gcc-3.4.2-p/libstdc++-v3/configure	2004-11-05 02:34:23.000000000 +0100
@@ -8168,7 +8168,7 @@
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
 
-  ldver=`$LD --version 2>/dev/null | head -1 | \
+  ldver=`$LD --version 2>/dev/null | head -n1 | \
          sed -e 's/GNU ld version \([0-9.][0-9.]*\).*/\1/'`
 
   glibcxx_gnu_ld_version=`echo $ldver | \
@@ -53531,7 +53531,7 @@
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
 
-  ldver=`$LD --version 2>/dev/null | head -1 | \
+  ldver=`$LD --version 2>/dev/null | head -n1 | \
          sed -e 's/GNU ld version \([0-9.][0-9.]*\).*/\1/'`
 
   glibcxx_gnu_ld_version=`echo $ldver | \
@@ -75201,7 +75201,7 @@
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
 
-  ldver=`$LD --version 2>/dev/null | head -1 | \
+  ldver=`$LD --version 2>/dev/null | head -n1 | \
          sed -e 's/GNU ld version \([0-9.][0-9.]*\).*/\1/'`
 
   glibcxx_gnu_ld_version=`echo $ldver | \
@@ -77569,7 +77569,7 @@
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
 
-  ldver=`$LD --version 2>/dev/null | head -1 | \
+  ldver=`$LD --version 2>/dev/null | head -n1 | \
          sed -e 's/GNU ld version \([0-9.][0-9.]*\).*/\1/'`
 
   glibcxx_gnu_ld_version=`echo $ldver | \
@@ -79813,7 +79813,7 @@
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
 
-  ldver=`$LD --version 2>/dev/null | head -1 | \
+  ldver=`$LD --version 2>/dev/null | head -n1 | \
          sed -e 's/GNU ld version \([0-9.][0-9.]*\).*/\1/'`
 
   glibcxx_gnu_ld_version=`echo $ldver | \
@@ -82825,7 +82825,7 @@
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
 
-  ldver=`$LD --version 2>/dev/null | head -1 | \
+  ldver=`$LD --version 2>/dev/null | head -n1 | \
          sed -e 's/GNU ld version \([0-9.][0-9.]*\).*/\1/'`
 
   glibcxx_gnu_ld_version=`echo $ldver | \
@@ -85022,7 +85022,7 @@
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
 
-  ldver=`$LD --version 2>/dev/null | head -1 | \
+  ldver=`$LD --version 2>/dev/null | head -n1 | \
          sed -e 's/GNU ld version \([0-9.][0-9.]*\).*/\1/'`
 
   glibcxx_gnu_ld_version=`echo $ldver | \
@@ -87110,7 +87110,7 @@
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
 
-  ldver=`$LD --version 2>/dev/null | head -1 | \
+  ldver=`$LD --version 2>/dev/null | head -n1 | \
          sed -e 's/GNU ld version \([0-9.][0-9.]*\).*/\1/'`
 
   glibcxx_gnu_ld_version=`echo $ldver | \
@@ -91165,7 +91165,7 @@
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
 
-  ldver=`$LD --version 2>/dev/null | head -1 | \
+  ldver=`$LD --version 2>/dev/null | head -n1 | \
          sed -e 's/GNU ld version \([0-9.][0-9.]*\).*/\1/'`
 
   glibcxx_gnu_ld_version=`echo $ldver | \
Nur in gcc-3.4.2-p/libstdc++-v3: configure~.
Nur in gcc-3.4.2-p/libstdc++-v3: configure.rej.
diff -dur gcc-3.4.2/libstdc++-v3/scripts/check_survey.in gcc-3.4.2-p/libstdc++-v3/scripts/check_survey.in
--- gcc-3.4.2/libstdc++-v3/scripts/check_survey.in	2003-07-05 08:00:05.000000000 +0200
+++ gcc-3.4.2-p/libstdc++-v3/scripts/check_survey.in	2004-11-05 02:27:05.000000000 +0100
@@ -182,9 +182,9 @@
     function size_command()
     {
       case $1 in
-        TEXT)  TEXT=$(size -B $EXENAME | tail -1 | awk '{print $1}')  ;;
-        DATA)  DATA=$(size -B $EXENAME | tail -1 | awk '{print $2}')  ;;
-        SIZE)  SIZE=$(size -B $EXENAME | tail -1 | awk '{print $4}')  ;;
+        TEXT)  TEXT=$(size -B $EXENAME | tail -n1 | awk '{print $1}')  ;;
+        DATA)  DATA=$(size -B $EXENAME | tail -n1 | awk '{print $2}')  ;;
+        SIZE)  SIZE=$(size -B $EXENAME | tail -n1 | awk '{print $4}')  ;;
       esac
     }
   else
diff -dur gcc-3.4.2/ltcf-c.sh gcc-3.4.2-p/ltcf-c.sh
--- gcc-3.4.2/ltcf-c.sh	2003-11-19 06:29:32.000000000 +0100
+++ gcc-3.4.2-p/ltcf-c.sh	2004-11-05 02:27:05.000000000 +0100
@@ -153,7 +153,7 @@
     # If the export-symbols file already is a .def file (1st line
     # is EXPORTS), use it as is.
     # If DATA tags from a recent dlltool are present, honour them!
-    archive_expsym_cmds='if test "x`head -1 $export_symbols`" = xEXPORTS; then
+    archive_expsym_cmds='if test "x`head -n1 $export_symbols`" = xEXPORTS; then
         cp $export_symbols $output_objdir/$soname-def;
       else
         echo EXPORTS > $output_objdir/$soname-def;
diff -dur gcc-3.4.2/ltcf-gcj.sh gcc-3.4.2-p/ltcf-gcj.sh
--- gcc-3.4.2/ltcf-gcj.sh	2003-11-19 06:29:32.000000000 +0100
+++ gcc-3.4.2-p/ltcf-gcj.sh	2004-11-05 02:27:05.000000000 +0100
@@ -156,7 +156,7 @@
     # If the export-symbols file already is a .def file (1st line
     # is EXPORTS), use it as is.
     # If DATA tags from a recent dlltool are present, honour them!
-    archive_expsym_cmds='if test "x`head -1 $export_symbols`" = xEXPORTS; then
+    archive_expsym_cmds='if test "x`head -n1 $export_symbols`" = xEXPORTS; then
         cp $export_symbols $output_objdir/$soname-def;
       else
         echo EXPORTS > $output_objdir/$soname-def;
