# --- ROCK-COPYRIGHT-NOTE-BEGIN ---
# 
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# Please add additional copyright information _after_ the line containing
# the ROCK-COPYRIGHT-NOTE-END tag. Otherwise it might get removed by
# the ./scripts/Create-CopyPatch script. Do not edit this copyright text!
# 
# ROCK Linux: rock-src/package/blindcoder/dgamelaunch/dgamelaunch.conf
# ROCK Linux is Copyright (C) 1998 - 2006 Clifford Wolf
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version. A copy of the GNU General Public
# License can be found at Documentation/COPYING.
# 
# Many people helped and are helping developing ROCK Linux. Please
# have a look at http://www.rocklinux.org/ and the Documentation/TEAM
# file for details.
# 
# --- ROCK-COPYRIGHT-NOTE-END ---

dgamelaunch_postmake(){
	cp ${confdir}/etc_dgamelaunch.conf ${root}/etc/dgamelaunch.conf
	mkdir -p ${root}/usr/games/lib/dgamelaunch/inprogress
	mkdir -p ${root}/usr/games/lib/dgamelaunch/mail
	mkdir -p ${root}/usr/games/lib/dgamelaunch/rcfiles
	mkdir -p ${root}/usr/games/lib/dgamelaunch/ttyrec
	touch ${root}/usr/games/lib/dgamelaunch/dgl-lock
	touch ${root}/usr/games/lib/dgamelaunch/dgl-login
	cat >>${root}/usr/games/lib/dgamelaunch/dgl-banner<<EOF
## dgamelaunch - network console game launcher
## version $VERSION
##
## (c)2001-4 M. Drew Streib. This program's source is released under the GPL.
## Send mail to <dtype@dtype.org> for details or a copy of the source code.
## ** Games on this server are recorded for in-progress viewing and playback!
EOF
	cat >>${root}/usr/games/lib/dgamelaunch/dgl-default-rcfile <<-EOF
# This is an example nethackrc file. You should edit this to suit the needs
# of your personal nethack build and add some reasonable default options
# for your users.

# If you compiled dgamelaunch with the \`vi' editor enabled instead of ee,
# perhaps a helpful blurb such as this might help:

# This editor is vi-like. Type ESC a couple times, then ':q!' (without quotes)
# to exit if you get stuck. To save, hit ESC and then ZZ or type ':wq'
# (without quotes.) To insert text, hit 'i' to enter insert mode.

# Here are some examples of reasonable defaults:

OPTIONS=showexp,showscore,time,color,!autopickup
OPTIONS=autodig,fruit:slime mold,boulder:0

# For more information on what you can set in your nethackrc file, refer to:
#   http://www.nethack.org/v343/Guidebook.html#_TOCentry_42
# Happy hacking!
EOF

	echo -e "#!/bin/bash\n/usr/sbin/dgamelaunch -q -f /etc/dgamelaunch.conf" >${root}/usr/sbin/dgamelaunch_telnetd
	chmod +x ${root}/usr/sbin/dgamelaunch_telnetd
	chown 0.0 ${root}/usr/sbin/dgamelaunch_telnetd
	chown 2.4 ${root}/usr/games/lib/dgamelaunch/ -R
	chmod g+w ${root}/usr/games/lib/dgamelaunch/ -R
}

postmake=dgamelaunch_postmake
